{
	"name": "DF_Gaant_Hurry",
	"properties": {
		"folder": {
			"name": "DWH/Facts"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "MILESTONEMAINTABLE",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "DRYAREAGAANTFINAL",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "WETAREAGAANTFINAL",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "CORRIDORGAANTFINAL",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "KITCHENGAANTFINAL",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "BALCONYGAANTFINAL",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "SLIDINGDOORGAANTFINAL",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "KITCHENCABINETGAANTFINAL",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "KEEPOUTGAANTFINAL",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "BLOCKWORKGAANTFINAL",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "BALUSTRADEWORKSGAANTFINAL",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "STRUCTUREGAANTFINAL",
					"description": "Import data from DS_Gaant_Hurry_Src"
				},
				{
					"dataset": {
						"referenceName": "DS_PROJECTS_NEW_TRG",
						"type": "DatasetReference"
					},
					"name": "PLNPROJECTSDIM"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "MILESTONEMAINTABLEPlan",
					"description": "Add data to MILESTONE_MAIN_TABLE_Plan"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "ManualActuals"
				},
				{
					"dataset": {
						"referenceName": "DS_Gaant_Hurry_Src",
						"type": "DatasetReference"
					},
					"name": "OPLNMILESTONEMAPSTG"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DS_GAANT_HURRY_TRG",
						"type": "DatasetReference"
					},
					"name": "sink1",
					"description": "Export data to DS_GAANT_HURRY_TRG"
				}
			],
			"transformations": [
				{
					"name": "surrogateKey1"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "union1"
				},
				{
					"name": "ACTUALSCOLLECTOR"
				},
				{
					"name": "joinwithProjectsDim",
					"description": "leftjoinMILESTONEMAINTABLEwithPLNPROJECTSDIM"
				},
				{
					"name": "joinwithACTUALSCOLLECTOR",
					"description": "left join with ACTUALS_COLLECTOR"
				},
				{
					"name": "select1"
				},
				{
					"name": "ActualAchivedColumn"
				},
				{
					"name": "OUTPUTPlan"
				},
				{
					"name": "LegendderivedColumnForOutputplan"
				},
				{
					"name": "selectListforMILESTONEMAINTABLEPlan"
				},
				{
					"name": "LegendderivedColumnForMILESTONEMAINTABLEPlan"
				},
				{
					"name": "UnionAllFinal"
				},
				{
					"name": "join1"
				},
				{
					"name": "select2"
				},
				{
					"name": "ActualAchivedderivedColumn"
				},
				{
					"name": "ActualAchivedderivedColumn2"
				},
				{
					"name": "PLNACTderivedColumn"
				},
				{
					"name": "ActivityNewfilter"
				},
				{
					"name": "AUGGAANTTEST"
				},
				{
					"name": "SEPTGAANTTESTTemp"
				},
				{
					"name": "SEPTGAANTTEST"
				},
				{
					"name": "ManualAdditionToCode"
				},
				{
					"name": "FinalFinalderivedColumn"
				},
				{
					"name": "PLNACTNewderivedColumn"
				},
				{
					"name": "Finalselect"
				}
			],
			"scriptLines": [
				"parameters{",
				"     MAX_ID as integer (0)",
				"}",
				"source(output(",
				"          Upload_Time as date,",
				"          project_id as string,",
				"          Group as string,",
				"          Activity_Description as string,",
				"          Actual_Start_Date as date,",
				"          Actual_Finish_Date as date,",
				"          Total_days as integer,",
				"          Days_elapsed as integer,",
				"          Source_Templet as string,",
				"          Sort_Group as integer,",
				"          Sort_Activity as integer,",
				"          Activity_New as string,",
				"          FLAT_COUNT as integer,",
				"          Actual_Percentage as string",
				"     ),",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: '\\n \\n SELECT DC.Upload_Time as Upload_Time,\\n        DC.project_id as project_id,\\n        DC.[Group] as [Group],\\n        DC.[Activity_Description] as [Activity_Description],\\n        DC.[Actual_Start_Date] as [Actual_Start_Date],\\n        DC.[Actual_Finish_Date] as [Actual_Finish_Date],\\n          DATEDIFF(DAY,DC.[Actual_Finish_Date], DC.[Actual_Start_Date]) AS Total_days,\\n        DATEDIFF(DAY,GETDATE(), DC.[Actual_Start_Date]) AS Days_elapsed,\\n       CASE \\n            WHEN DC.[Group] = \\'Structural Works\\' AND DC.[Activity_Description] IN (\\'Pile Cap\\',\\'Pile\\')  THEN \\'MANUAL_ENTRY\\'\\n            WHEN DC.[Group] = \\'External Elevation\\' AND DC.[Activity_Description] IN (\\'ACP Works\\')  THEN \\'MANUAL_ENTRY\\'\\n            WHEN DC.[Group] = \\'Other & Specialist\\' AND DC.[Activity_Description] IN (\\'Lift - CTU\\',\\'Lift - Balance passenger lifts\\',\\'Swimming Pool\\',\\'Kids Play Area/ Outdoor Play Area\\',\\n               \\'Changing Rooms / GYM\\',\\'Wooden Decking\\')  THEN \\'MANUAL_ENTRY\\'\\n            WHEN DC.[Group] = \\'Authority Approvals\\' AND DC.[Activity_Description] IN (\\'Transformer payment\\',\\'LV Inspection & Approval\\',\\'BCC - Inspection & Approval\\',\\'Power on\\') THEN \\'MANUAL_ENTRY\\'\\n            WHEN DC.[Group] = \\'Structural Works\\' AND DC.[Activity_Description] IN (\\'Grade Slab\\',\\'Podium Slabs\\',\\'Typical Floor Slabs\\')  THEN \\'PLN_STRUCTURE_FACT\\'\\n            WHEN DC.[Group] = \\'Structural Works\\' AND DC.[Activity_Description] NOT IN (\\'Pile\\',\\'Pile Cap\\',\\'Grade Slab\\',\\'Podium Slabs\\',\\'Typical Floor Slabs\\')  THEN \\'TBD\\'\\n            WHEN DC.[Group] = \\'Masonary Works\\' AND DC.[Activity_Description] IN (\\'Blockworks\\')  THEN \\'PLN_DRYAREA_FACT\\'\\n            WHEN DC.[Group] = \\'Finishes - Dry Area\\' THEN \\'PLN_DRYAREA_FACT\\'\\n            WHEN DC.[Group] = \\'External Elevation\\' AND DC.[Activity_Description] IN (\\'Sliding Door\\')  THEN \\'PLN_DRYAREA_FACT\\'\\n            WHEN DC.[Group] = \\'Finishes - Wet Area\\' THEN \\'PLN_WETAREA_FACT\\'\\n            WHEN DC.[Group] = \\'Joinery Works\\' AND DC.[Activity_Description] IN (\\'Vanity Cabinet\\')  THEN \\'PLN_WETAREA_FACT\\'\\n            WHEN DC.[Group] = \\'Finishes - Corridor\\' THEN \\'PLN_CORRIDOR_FACT\\'\\n            WHEN DC.[Group] = \\'External Elevation\\' AND DC.[Activity_Description] IN (\\'EIFS\\',\\'Balustrade Works\\')  THEN \\'PLN_BALCONYAREA_FACT\\'\\n            WHEN DC.[Group] = \\'Other & Specialist\\' AND DC.[Activity_Description] IN (\\'Kitchen Appliances\\')  THEN \\'PLN_KITCHENAREA_FACT\\'\\n            WHEN DC.[Group] = \\'Joinery Works\\' AND DC.[Activity_Description] IN (\\'Kitchen Cabinet\\')  THEN \\'PLN_KITCHENAREA_FACT\\'\\n            WHEN DC.[Group] = \\'Keepout\\' THEN \\'PLN_KEEPOUT_FACT\\'\\n            WHEN DC.[Group] = \\'Authority Approvals\\' AND DC.[Activity_Description] NOT IN (\\'Transformer payment\\',\\'LV Inspection & Approval\\',\\'BCC - Inspection & Approval\\',\\'Power on\\') THEN \\'TBD\\'\\n            WHEN DC.[Group] = \\'External Elevation\\' AND DC.[Activity_Description] NOT IN (\\'Sliding Door\\',\\'EIFS\\',\\'Balustrade Works\\',\\'ACP Works\\')  THEN \\'TBD\\'\\n            WHEN DC.[Group] = \\'Other & Specialist\\' AND DC.[Activity_Description] NOT IN (\\n                                                                                    \\'Kitchen Appliances\\',\\n                                                                                    \\'Lift - CTU\\',\\n                                                                                    \\'Lift - Balance passenger lifts\\',\\n                                                                                    \\'Swimming Pool\\',\\n                                                                                    \\'Kids Play Area/ Outdoor Play Area\\',\\n                                                                                    \\'Changing Rooms / GYM\\',\\n                                                                                    \\'Wooden Decking\\')  THEN \\'TBD\\'\\n            WHEN DC.[Group] = \\'Joinery Works\\' AND DC.[Activity_Description] NOT IN (\\'Vanity Cabinet\\',\\'Kitchen Cabinet\\')  THEN \\'TBD\\'\\n            ELSE \\'MISSING\\'\\n        END AS Source_Templet,\\n        OLMP.Sort_Group as Sort_Group,\\n        OLMP.Sort_Activity as Sort_Activity,\\n        OLMP.Activity_New as Activity_New,\\n        P.FLAT_COUNT as FLAT_COUNT,\\n        DC.[Actual_Percentage] as [Actual_Percentage]\\n--INTO #MILESTONE_MAIN_TABLE\\n FROM  (\\n SELECT Upload_Time,\\n          project_id,\\n          [Group],\\n          [Activity_Description],\\n          CAST(CASE WHEN ISNULL(FC.[Actual_Start_Date],\\'\\') = \\'\\' THEN NULL\\n            WHEN FC.[Actual_Start_Date] LIKE \\'%/19\\' THEN REPLACE(FC.[Actual_Start_Date],\\'/19\\',\\'/2019\\')\\n            WHEN FC.[Actual_Start_Date] LIKE \\'%/20\\' THEN REPLACE(FC.[Actual_Start_Date],\\'/20\\',\\'/2020\\')\\n            WHEN FC.[Actual_Start_Date] LIKE \\'%/21\\' THEN REPLACE(FC.[Actual_Start_Date],\\'/21\\',\\'/2021\\')\\n            WHEN FC.[Actual_Start_Date] LIKE \\'%/22\\' THEN REPLACE(FC.[Actual_Start_Date],\\'/22\\',\\'/2022\\')\\n            WHEN FC.[Actual_Start_Date] LIKE \\'%/23\\' THEN REPLACE(FC.[Actual_Start_Date],\\'/23\\',\\'/2023\\')\\n            WHEN FC.[Actual_Start_Date] LIKE \\'%/24\\' THEN REPLACE(FC.[Actual_Start_Date],\\'/24\\',\\'/2024\\')\\n            ELSE FC.[Actual_Start_Date]\\n        END  AS DATE) [Actual_Start_Date], \\n          CAST(CASE WHEN ISNULL(FC.[Actual_Start_Date],\\'\\') = \\'\\' THEN NULL\\n            WHEN FC.[Actual_Finish_Date] LIKE \\'%/19\\' THEN REPLACE(FC.[Actual_Finish_Date],\\'/19\\',\\'/2019\\')\\n            WHEN FC.[Actual_Finish_Date] LIKE \\'%/20\\' THEN REPLACE(FC.[Actual_Finish_Date],\\'/20\\',\\'/2020\\')\\n            WHEN FC.[Actual_Finish_Date] LIKE \\'%/21\\' THEN REPLACE(FC.[Actual_Finish_Date],\\'/21\\',\\'/2021\\')\\n            WHEN FC.[Actual_Finish_Date] LIKE \\'%/22\\' THEN REPLACE(FC.[Actual_Finish_Date],\\'/22\\',\\'/2022\\')\\n            WHEN FC.[Actual_Finish_Date] LIKE \\'%/23\\' THEN REPLACE(FC.[Actual_Finish_Date],\\'/23\\',\\'/2023\\')\\n            WHEN FC.[Actual_Finish_Date] LIKE \\'%/24\\' THEN REPLACE(FC.[Actual_Finish_Date],\\'/24\\',\\'/2024\\')\\n            ELSE FC.[Actual_Finish_Date]\\n        END  AS DATE) [Actual_Finish_Date],\\n          [Actual_Percentage]\\n FROM  ( \\n SELECT\\n        CAST(OPM.upload_time AS DATE) AS Upload_Time,\\n        OPM.project_id,\\n        OPM.[Group],\\n        OPM.[Activity_Description],\\n        CASE \\n            WHEN OPM.[Actual_Forecast_Start] IS NULL OR TRIM(OPM.[Actual_Forecast_Start]) IN (\\'\\',\\'-\\',\\' \\') THEN REPLACE(OPM.[Baseline_Start],\\'-\\',\\'/\\')\\n            ELSE REPLACE(OPM.[Actual_Forecast_Start],\\'-\\',\\'/\\')\\n        END AS [Actual_Start_Date],\\n        CASE \\n            WHEN OPM.[Actual_Forecast_Start] IS NULL OR TRIM(OPM.[Actual_Forecast_Start]) IN (\\'\\',\\'-\\',\\' \\') THEN REPLACE(OPM.[Baseline_Start],\\'-\\',\\'/\\')\\n            ELSE REPLACE(OPM.[Actual_Forecast_Start],\\'-\\',\\'/\\')\\n        END [Actual_Finish_Date],\\n        DENSE_RANK() OVER( PARTITION BY OPM.project_id ORDER BY CAST(OPM.upload_time AS DATE) DESC) DENSERANK,\\n        OPM.[Actual_Percentage]\\n    FROM\\n        STG.O_PLN_MILESTONE_STG OPM \\n        WHERE \\n(OPM.[Group] IS NOT NULL AND TRIM(OPM.[Group]) NOT IN (\\'\\')\\n                AND OPM.[Activity_Description] IS NOT NULL AND TRIM(OPM.[Activity_Description]) NOT IN (\\'\\'))\\n) FC\\nWHERE FC.DENSERANK = 1\\n ) DC\\n inner JOIN STG.O_PLN_MILESTONE_MAP_STG OLMP\\n                ON DC.[Group] = OLMP.[Group] \\n                AND DC.[Activity_Description] = OLMP.Activity\\n LEFT JOIN STG.PROJECTS_STG P\\n                ON DC.project_id = P.Project_Identifier\\n',",
				"     format: 'query',",
				"     staged: true) ~> MILESTONEMAINTABLE",
				"source(output(",
				"          project_id as integer,",
				"          Type_of_work as string,",
				"          SUM_ALL as decimal(38,0),",
				"          Source_Table as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: '\\nSELECT      DAR.project_id,\\n            DAR.Type_of_work,\\n            --DENSE_RANK() OVER(PARTITION BY DAR.project_id ORDER BY DAR.tower) AS RANKER,\\n            SUM(DAR.value) AS SUM_ALL,\\n               \\'PLN_DRYAREA_FACT\\' AS Source_Table\\n--INTO #DRYAREA_GAANT_FINAL\\nFROM (\\nSELECT \\n            FPD.project_id,\\n            FPD.tower,\\n            FPD.[Level_ID],\\n            FPD.Flat,\\n            --FPD.sclicer,\\n            CAST(REPLACE(FPD.value,\\'%\\',\\'\\') AS DECIMAL) AS value,\\n            FPD.Type_of_work,\\n            FPD.ACTIVITY_ID\\nFROM [DWH].[PLN_DRYAREA_FACT] FPD\\nWHERE\\n            LOWER(FPD.Type_of_work) IN (\\n                                        \\'Plaster\\',\\n                                        \\'Screed\\',\\n                                        \\'Floor Tile\\',\\n                                        \\'FC Framing\\',\\n                                        \\'FC Boarding with Joint Taping\\',\\n                                        \\'Floor Tiling\\'\\n                                        )\\n            AND (FPD.value LIKE \\'1%\\'\\n                OR FPD.value LIKE \\'2%\\'\\n                OR FPD.value LIKE \\'3%\\'\\n                OR FPD.value LIKE \\'4%\\'\\n                OR FPD.value LIKE \\'5%\\'\\n                OR FPD.value LIKE \\'6%\\'\\n                OR FPD.value LIKE \\'7%\\'\\n                OR FPD.value LIKE \\'8%\\'\\n                OR FPD.value LIKE \\'9%\\'\\n                ) \\n                    \\n) DAR\\nGROUP BY project_id,Type_of_work          \\n',",
				"     format: 'query',",
				"     staged: true) ~> DRYAREAGAANTFINAL",
				"source(output(",
				"          project_id as integer,",
				"          Type_of_work as string,",
				"          SUM_ALL as decimal(38,0),",
				"          Source_Table as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT          WAR.project_id,\\n                WAR.Type_of_work,\\n                SUM(WAR.value) AS SUM_ALL,\\n                    \\'PLN_WETAREA_FACT\\' AS Source_Table\\nFROM (\\nSELECT \\n                WPD.project_id,\\n                WPD.tower,\\n                WPD.[Level_ID],\\n                WPD.Flat,\\n                --WPD.sclicer,\\n                CAST(REPLACE(WPD.value,\\'%\\',\\'\\') AS DECIMAL) AS value,\\n                WPD.Type_of_work,\\n                WPD.ACTIVITY_ID\\n            FROM [DWH].[PLN_WETAREA_FACT] WPD \\n            WHERE\\n                LOWER(WPD.Type_of_work) IN (\\n                                            \\'Wet Area Screed\\',\\n                                            \\'Wet Area MEP H/L Boarding Clearance\\',\\n                                            \\'Wall tile bottom Tile\\',\\n                                            \\'Wet Area FC Framing\\',\\n                                            \\'FC Boarding & Joint Taping\\',\\n                                            \\'Floor Tile\\',\\n                                            \\'Wet Area Final Fixtures Installation\\',\\n                                            \\'Vanity Cabinet\\'\\n                                            )\\n                AND (WPD.value LIKE \\'1%\\'\\n                    OR WPD.value LIKE \\'2%\\'\\n                    OR WPD.value LIKE \\'3%\\'\\n                    OR WPD.value LIKE \\'4%\\'\\n                    OR WPD.value LIKE \\'5%\\'\\n                    OR WPD.value LIKE \\'6%\\'\\n                    OR WPD.value LIKE \\'7%\\'\\n                    OR WPD.value LIKE \\'8%\\'\\n                    OR WPD.value LIKE \\'9%\\'\\n                    ) \\n) WAR\\nGROUP BY project_id,Type_of_work\\n',",
				"     format: 'query',",
				"     staged: true) ~> WETAREAGAANTFINAL",
				"source(output(",
				"          project_id as integer,",
				"          Type_of_work as string,",
				"          SUM_ALL as decimal(38,0),",
				"          Source_Table as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT \\n                CAR.project_id,\\n                CAR.Type_of_work,\\n                SUM(CAR.value) AS SUM_ALL,\\n                    \\'PLN_CORRIDOR_FACT\\' AS Source_Table\\nFROM (\\nSELECT \\n            FPC.project_id,\\n            FPC.tower,\\n            FPC.[Level_ID],\\n            --FPC.sclicer,\\n            CAST(REPLACE(FPC.value,\\'%\\',\\'\\') AS DECIMAL) AS value,\\n            FPC.Type_of_work,\\n            FPC.ACTIVITY_ID\\n        FROM [DWH].[PLN_CORRIDOR_FACT] FPC \\n        WHERE\\n            LOWER(FPC.Type_of_work) IN (\\n                                        \\'CORRIDOR Floor Tile\\',\\n                                        \\'CORRIDOR Wall Tile\\',\\n                                        \\'CORRIDOR FC Boarding\\'\\n                                        )\\n            AND (FPC.value LIKE \\'1%\\'\\n                OR FPC.value LIKE \\'2%\\'\\n                OR FPC.value LIKE \\'3%\\'\\n                OR FPC.value LIKE \\'4%\\'\\n                OR FPC.value LIKE \\'5%\\'\\n                OR FPC.value LIKE \\'6%\\'\\n                OR FPC.value LIKE \\'7%\\'\\n                OR FPC.value LIKE \\'8%\\'\\n                OR FPC.value LIKE \\'9%\\'\\n                ) \\n) CAR\\nGROUP BY project_id,Type_of_work\\n',",
				"     format: 'query',",
				"     staged: true) ~> CORRIDORGAANTFINAL",
				"source(output(",
				"          project_id as integer,",
				"          Type_of_work as string,",
				"          SUM_ALL as decimal(38,0),",
				"          Source_Table as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT \\n                KAR.project_id,\\n                KAR.Type_of_work,\\n                SUM(KAR.value) AS SUM_ALL,\\n                    \\'PLN_KITCHENAREA_FACT\\' AS Source_Table\\nFROM (\\nSELECT \\n                FPK.project_id,\\n                FPK.tower,\\n                FPK.[Level_ID],\\n                FPK.Flat,\\n               -- FPK.sclicer,\\n                CAST(REPLACE(CASE WHEN FPK.value= \\'#N/A\\' THEN NULL ELSE FPK.value END ,\\'%\\',\\'\\') AS DECIMAL) AS value,\\n                FPK.Type_of_work,\\n                FPK.ACTIVITY_ID\\n            FROM [DWH].[PLN_KITCHENAREA_FACT] FPK \\n            WHERE\\n                LOWER(FPK.Type_of_work) IN (\\n                                            \\'Kitchen Appliances\\'\\n                                            )\\n                AND (FPK.value LIKE \\'1%\\'\\n                    OR FPK.value LIKE \\'2%\\'\\n                    OR FPK.value LIKE \\'3%\\'\\n                    OR FPK.value LIKE \\'4%\\'\\n                    OR FPK.value LIKE \\'5%\\'\\n                    OR FPK.value LIKE \\'6%\\'\\n                    OR FPK.value LIKE \\'7%\\'\\n                    OR FPK.value LIKE \\'8%\\'\\n                    OR FPK.value LIKE \\'9%\\'\\n                    )\\n) KAR\\nGROUP BY project_id,Type_of_work\\n',",
				"     format: 'query',",
				"     staged: true) ~> KITCHENGAANTFINAL",
				"source(output(",
				"          project_id as integer,",
				"          Type_of_work as string,",
				"          SUM_ALL as decimal(38,0),",
				"          Source_Table as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT \\n                BAR.project_id,\\n                BAR.Type_of_work,\\n                SUM(BAR.value) AS SUM_ALL,\\n                    \\'PLN_BALCONYAREA_FACT\\' AS Source_Table\\nFROM (\\nSELECT \\n                FPB.project_id,\\n                FPB.tower,\\n                FPB.[Level_ID],\\n                FPB.Flat,\\n                --FPB.sclicer,\\n                CAST(REPLACE(FPB.value,\\'%\\',\\'\\') AS DECIMAL) AS value,\\n                FPB.Type_of_work,\\n                FPB.ACTIVITY_ID\\n            FROM [DWH].[PLN_BALCONYAREA_FACT] FPB \\n            WHERE\\n                LOWER(FPB.Type_of_work) IN (\\n                                            \\'EIFS Installation\\'\\n                                            )\\n                AND (FPB.value LIKE \\'1%\\'\\n                    OR FPB.value LIKE \\'2%\\'\\n                    OR FPB.value LIKE \\'3%\\'\\n                    OR FPB.value LIKE \\'4%\\'\\n                    OR FPB.value LIKE \\'5%\\'\\n                    OR FPB.value LIKE \\'6%\\'\\n                    OR FPB.value LIKE \\'7%\\'\\n                    OR FPB.value LIKE \\'8%\\'\\n                    OR FPB.value LIKE \\'9%\\'\\n                    )\\n) BAR\\nGROUP BY project_id,Type_of_work\\n',",
				"     format: 'query',",
				"     staged: true) ~> BALCONYGAANTFINAL",
				"source(output(",
				"          project_id as integer,",
				"          Type_of_work as string,",
				"          SUM_ALL as decimal(38,2),",
				"          Source_Table as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT \\n                SGS.project_id,\\n                \\'Sliding Door\\' AS Type_of_work,\\n                SUM(Multiply_Factor*SUM_ALL) AS SUM_ALL,\\n                \\'PLN_DRYAREA_FACT\\' AS Source_Table\\nFROM (\\nSELECT \\n                SDR.project_id,\\n                SDR.Type_of_work,\\n                    CASE \\n                    WHEN Type_of_work = \\'Sliding Door Box Installation\\'     THEN 0.1\\n                    WHEN Type_of_work = \\'Sliding Door Frame Installation\\'     THEN 0.2\\n                    WHEN Type_of_work = \\'Sliding Door Glass Installation\\'     THEN 0.45\\n                    WHEN Type_of_work = \\'Sliding Door Internal Silicone\\'     THEN 0.1\\n                    WHEN Type_of_work = \\'Sliding Door Alignment\\'             THEN 0.05\\n                    WHEN Type_of_work = \\'Sliding Door External Silicone\\'     THEN 0.1\\n                END AS Multiply_Factor,\\n                SUM(SDR.value) AS SUM_ALL\\nFROM (\\nSELECT \\n            FPD.project_id,\\n            FPD.tower,\\n            FPD.[Level_ID],\\n            FPD.Flat,\\n            --FPD.sclicer,\\n            CAST(REPLACE(FPD.value,\\'%\\',\\'\\') AS DECIMAL) AS value,\\n            FPD.Type_of_work,\\n            FPD.ACTIVITY_ID\\n        FROM [DWH].[PLN_DRYAREA_FACT] FPD \\n        WHERE\\n            LOWER(FPD.Type_of_work) IN (\\n                                        \\'Sliding Door Box Installation\\',\\n                                        \\'Sliding Door Frame Installation\\',\\n                                        \\'Sliding Door Glass Installation\\',\\n                                        \\'Sliding Door Internal Silicone\\',\\n                                        \\'Sliding Door Alignment\\',\\n                                        \\'Sliding Door External Silicone\\'\\n                                        )\\n            AND (FPD.value LIKE \\'1%\\'\\n                OR FPD.value LIKE \\'2%\\'\\n                OR FPD.value LIKE \\'3%\\'\\n                OR FPD.value LIKE \\'4%\\'\\n                OR FPD.value LIKE \\'5%\\'\\n                OR FPD.value LIKE \\'6%\\'\\n                OR FPD.value LIKE \\'7%\\'\\n                OR FPD.value LIKE \\'8%\\'\\n                OR FPD.value LIKE \\'9%\\'\\n                )\\n) SDR\\nGROUP BY project_id,Type_of_work\\n)SGS\\nGROUP BY project_id\\n',",
				"     format: 'query',",
				"     staged: true) ~> SLIDINGDOORGAANTFINAL",
				"source(output(",
				"          project_id as integer,",
				"          Type_of_work as string,",
				"          SUM_ALL as decimal(38,2),",
				"          Source_Table as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT \\n                SGS.project_id,\\n                \\'Kitchen Cabinet\\' AS Type_of_work,\\n                SUM(Multiply_Factor*SUM_ALL) AS SUM_ALL,\\n                \\'PLN_KITCHENAREA_FACT\\' AS Source_Table\\nFROM (\\nSELECT \\n                SDR.project_id,\\n                SDR.Type_of_work,\\n                SUM(SDR.value) AS SUM_ALL,\\n                    CASE \\n                    WHEN Type_of_work = \\'Kitchen Cabinet\\'                 THEN 0.5\\n                    WHEN Type_of_work = \\'Kitchen Counter Plywood\\'         THEN 0.1\\n                    WHEN Type_of_work = \\'Kitchen Counter Top\\'             THEN 0.2\\n                    WHEN Type_of_work = \\'Kitchen Counter Top Skirting\\'     THEN 0.1\\n                    WHEN Type_of_work = \\'Kitchen Cabinet Grouting\\'         THEN 0.05\\n                    WHEN Type_of_work = \\'Kitchen Cabinet Silicone\\'         THEN 0.05\\n                END AS Multiply_Factor\\nFROM (\\nSELECT \\n            FPK.project_id,\\n            FPK.tower,\\n            FPK.[Level_ID],\\n            FPK.Flat,\\n           -- FPK.sclicer,\\n            CAST(REPLACE(FPK.value,\\'%\\',\\'\\') AS DECIMAL) AS value,\\n            FPK.Type_of_work,\\n            FPK.ACTIVITY_ID\\n        FROM [DWH].[PLN_KITCHENAREA_FACT] FPK \\n        WHERE\\n            LOWER(FPK.Type_of_work) IN (\\n                                        \\'Kitchen Cabinet\\',\\n                                        \\'Kitchen Counter Plywood\\',\\n                                        \\'Kitchen Counter Top\\',\\n                                        \\'Kitchen Counter Top Skirting\\',\\n                                        \\'Kitchen Cabinet Grouting\\',\\n                                        \\'Kitchen Cabinet Silicone\\'\\n                                        )\\n            AND (FPK.value LIKE \\'1%\\'\\n                OR FPK.value LIKE \\'2%\\'\\n                OR FPK.value LIKE \\'3%\\'\\n                OR FPK.value LIKE \\'4%\\'\\n                OR FPK.value LIKE \\'5%\\'\\n                OR FPK.value LIKE \\'6%\\'\\n                OR FPK.value LIKE \\'7%\\'\\n                OR FPK.value LIKE \\'8%\\'\\n                OR FPK.value LIKE \\'9%\\'\\n                )\\n) SDR\\nGROUP BY project_id,Type_of_work\\n)SGS\\nGROUP BY project_id\\n',",
				"     format: 'query',",
				"     staged: true) ~> KITCHENCABINETGAANTFINAL",
				"source(output(",
				"          project_id as integer,",
				"          Type_of_work as string,",
				"          SUM_ALL as decimal(38,0),",
				"          Source_Table as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT \\n                KAA.project_id,\\n                KAA.Type_of_work,\\n                (KAA.SUM_ALL*100) AS SUM_ALL,\\n                \\'PLN_KEEPOUT_FACT\\' AS Source_Table\\nFROM (\\nSELECT \\n                KAR.project_id,\\n                KAR.Type_of_work,\\n                SUM(KAR.value) AS SUM_ALL\\nFROM (\\nSELECT \\n                FPK.project_id,\\n                FPK.tower,\\n                --FPK.[Level_ID],\\n                FPK.Flat,\\n                \\'Keep Out\\' AS sclicer,\\n                CAST(REPLACE(FPK.value,\\'%\\',\\'\\') AS DECIMAL) AS value,\\n                FPK.Type_of_work,\\n                FPK.ACTIVITY_ID\\n            FROM [DWH].[PLN_KEEPOUT_FACT] FPK \\n            WHERE\\n                LOWER(FPK.Type_of_work) IN (\\n                                            \\'Bathroom Stamp - Civil (L9)\\',\\n                                            \\'Kitchen Stamp - Civil (I9)\\',\\n                                            \\'Keep Out (QT)\\'\\n                                            )\\n                AND (FPK.value LIKE \\'1%\\'\\n                    OR FPK.value LIKE \\'2%\\'\\n                    OR FPK.value LIKE \\'3%\\'\\n                    OR FPK.value LIKE \\'4%\\'\\n                    OR FPK.value LIKE \\'5%\\'\\n                    OR FPK.value LIKE \\'6%\\'\\n                    OR FPK.value LIKE \\'7%\\'\\n                    OR FPK.value LIKE \\'8%\\'\\n                    OR FPK.value LIKE \\'9%\\'\\n                    )\\n) KAR\\nGROUP BY project_id,Type_of_work,tower,ACTIVITY_ID\\n)KAA\\nGROUP BY project_id,Type_of_work,SUM_ALL\\n',",
				"     format: 'query',",
				"     staged: true) ~> KEEPOUTGAANTFINAL",
				"source(output(",
				"          project_id as integer,",
				"          Type_of_work as string,",
				"          SUM_ALL as decimal(38,1),",
				"          Source_Table as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT \\n                BGS.project_id,\\n                \\'Blockwork\\' AS Type_of_work,\\n                SUM(BGS.Multiply_Factor*BGS.SUM_ALL) AS SUM_ALL,\\n                \\'PLN_DRYAREA_FACT\\' AS Source_Table\\nFROM (\\nSELECT \\n                BWR.project_id,\\n                BWR.Type_of_work,\\n                SUM(BWR.value) AS SUM_ALL,\\n                    CASE \\n                    WHEN Type_of_work = \\'Blockwork First Layer\\'     THEN 0.2\\n                    WHEN Type_of_work = \\'Blockwork\\'                 THEN 0.4\\n                    WHEN Type_of_work = \\'GI Lintel\\'                 THEN 0.1\\n                    WHEN Type_of_work = \\'Above Lintel Block Work\\'     THEN 0.3\\n                END AS Multiply_Factor\\nFROM (\\nSELECT \\n            FPD.project_id,\\n            FPD.tower,\\n            FPD.[Level_ID],\\n            FPD.Flat,\\n            --FPD.sclicer,\\n            CAST(REPLACE(FPD.value,\\'%\\',\\'\\') AS DECIMAL) AS value,\\n            FPD.Type_of_work,\\n            FPD.ACTIVITY_ID\\n        FROM [DWH].[PLN_DRYAREA_FACT] FPD \\n        WHERE\\n            LOWER(FPD.Type_of_work) IN (\\'Blockwork First Layer\\',\\'Blockwork\\',\\'GI Lintel\\',\\'Above Lintel Block Work\\')\\n            AND (FPD.value LIKE \\'1%\\'OR FPD.value LIKE \\'2%\\'OR FPD.value LIKE \\'3%\\'OR FPD.value LIKE \\'4%\\'OR FPD.value LIKE \\'5%\\' OR FPD.value LIKE \\'6%\\'OR FPD.value LIKE \\'7%\\'OR FPD.value LIKE \\'8%\\'\\n                OR FPD.value LIKE \\'9%\\' )\\n) BWR\\nGROUP BY project_id,Type_of_work\\n)BGS\\nGROUP BY project_id\\n',",
				"     format: 'query',",
				"     staged: true) ~> BLOCKWORKGAANTFINAL",
				"source(output(",
				"          project_id as integer,",
				"          Type_of_work as string,",
				"          SUM_ALL as decimal(38,1),",
				"          Source_Table as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT \\n                BGS.project_id,\\n                \\'Balustrade Works\\' AS Type_of_work,\\n                SUM(BGS.Multiply_Factor*BGS.SUM_ALL) AS SUM_ALL,\\n                \\'PLN_DRYAREA_FACT\\' AS Source_Table\\nFROM (\\nSELECT \\n                BWR.project_id,\\n                BWR.Type_of_work,\\n                SUM(BWR.value) AS SUM_ALL,\\n                    CASE \\n                    WHEN Type_of_work = \\'F channel Installation\\'             THEN 0.2\\n                    WHEN Type_of_work = \\'Top Rail Bracket Installation\\'        THEN 0.2\\n                    WHEN Type_of_work = \\'Balustrade Glass Installation\\'        THEN 0.2\\n                    WHEN Type_of_work = \\'Balustrade Top Rail\\'                 THEN 0.2\\n                    WHEN Type_of_work = \\'Balustrade-Internal Flashing\\'        THEN 0.2\\n                END AS Multiply_Factor\\nFROM (\\nSELECT \\n            FPB.project_id,\\n            FPB.tower,\\n            FPB.[Level_ID],\\n            FPB.Flat,\\n            --FPB.sclicer,\\n            CAST(REPLACE(FPB.value,\\'%\\',\\'\\') AS DECIMAL) AS value,\\n            FPB.Type_of_work,\\n            FPB.ACTIVITY_ID\\n        FROM [DWH].[PLN_DRYAREA_FACT] FPB \\n        WHERE\\n            LOWER(FPB.Type_of_work) IN (\\'F channel Installation\\',\\'Top Rail Bracket Installation\\',\\'Balustrade Glass Installation\\',\\'Balustrade Top Rail\\',\\'Balustrade-Internal Flashing\\')\\n            AND (FPB.value LIKE \\'1%\\'OR FPB.value LIKE \\'2%\\'OR FPB.value LIKE \\'3%\\'OR FPB.value LIKE \\'4%\\'OR FPB.value LIKE \\'5%\\'OR FPB.value LIKE \\'6%\\'OR FPB.value LIKE \\'7%\\'OR FPB.value LIKE \\'8%\\'OR FPB.value LIKE \\'9%\\')\\n) BWR\\nGROUP BY project_id,Type_of_work\\n)BGS\\nGROUP BY project_id\\n',",
				"     format: 'query',",
				"     staged: true) ~> BALUSTRADEWORKSGAANTFINAL",
				"source(output(",
				"          project_id as integer,",
				"          Type_of_work as string,",
				"          SUM_ALL as decimal(30,2),",
				"          Source_Table as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT \\n            P.project_id,\\n            SGF.Type_of_work,\\n            (SGF.SUM_ALL*P.FLAT_COUNT)*100 AS SUM_ALL,\\n            SGF.Source_Table\\nFROM (\\nSELECT \\n            Project_Identifier AS project_id,\\n               --GS_Count,\\n            \\'Grade Slab\\' AS  Type_of_work,\\n            --GS_COMPLETED ,\\n            CAST((GS_COMPLETED/GS_Count) AS DECIMAL(15,2)) AS SUM_ALL,\\n               \\'PLN_STRUCTURE_FACT\\' AS Source_Table\\n--INTO GRADE_SLAB_FINAL\\nFROM (\\nSELECT     \\n            P.Project_Identifier,\\n            COUNT(*) AS GS_Count,GS_COMPLETED\\n        FROM [STG].[O_PLN_STRUCTURES_POUR_MAP_STG]  OSPM \\n            LEFT JOIN [DWH].[PLN_PROJECTS_DIM] P \\n            ON OSPM.project_id  = P.Project_Identifier\\n          LEFT JOIN\\n( SELECT \\n            p.Project_Identifier,\\n            COUNT(FPS.[Level_ID]) AS GS_COMPLETED\\n        FROM [DWH].[PLN_STRUCTURE_FACT] FPS\\n          LEFT JOIN [DWH].[PLN_PROJECTS_DIM] P \\n            ON FPS.project_id  = P.project_id\\n          LEFT JOIN [DWH].[PLN_LEVEL_MAP_ALL_DIM] L \\n            ON FPS.[Level_ID]  = L.[Level_Map_ID]\\n        WHERE LOWER(L.[Level]) LIKE \\'%grade slab%\\' \\n            AND value IS NOT NULL \\n        GROUP BY p.Project_Identifier\\n)  GSCM ON P.Project_Identifier = GSCM.Project_Identifier\\nWHERE LOWER(OSPM.type_of_pour) LIKE \\'slab%\\'\\n          GROUP BY P.Project_Identifier,GS_COMPLETED\\n) GSCU\\n\\nUNION ALL \\n\\nSELECT \\n        CV.Project_Identifier AS project_id,\\n          CV.Area AS Type_of_work,\\n        --A.Total_Completed,\\n        CAST((A.Total_Completed/CV.Value) AS DECIMAL(15,2)) AS SUM_ALL,\\n          \\'PLN_STRUCTURE_FACT\\' AS Source_Table\\n--INTO OTHER_SLABS_FINAL\\nFROM (\\n SELECT Project_Identifier, Area,Value\\n --INTO COUNT_VALUE\\n FROM (SELECT *,\\n          (Total_Podiums*Podium_Slab) AS PODIUM_COUNT,\\n        (Total_Typical_Floor*Typical_Floor_Slab) AS TYPICAL_FLOOR_COUNT\\nFROM [DWH].[PLN_PROJECTS_DIM] ) p\\n            CROSS APPLY ( \\n                                     SELECT [PODIUM_COUNT],\\'Podium\\' \\n                    UNION ALL SELECT [TYPICAL_FLOOR_COUNT],\\'Typical Floor\\' \\n                                ) AS Virtual_table(Value,Area)\\nWHERE Value IS NOT NULL ) CV\\nLEFT JOIN  (\\nSELECT \\n            P.Project_Identifier,\\n            OPTPM.Area ,\\n            COUNT(FPS.Pour) Total_Completed \\n--INTO ACTUALS_OTHER_SLABS\\n        FROM [DWH].[PLN_STRUCTURE_FACT]  FPS\\n               LEFT JOIN [DWH].[PLN_PROJECTS_DIM] P \\n            ON FPS.project_id  = P.project_id\\n               LEFT JOIN [DWH].[PLN_LEVEL_MAP_ALL_DIM] L \\n            ON FPS.[Level_ID]  = L.[Level_Map_ID]\\n            LEFT JOIN [STG].[O_PLN_TOWER_PODIUM_MAP_STG]  OPTPM\\n                ON P.Project_Identifier = OPTPM.Project \\n WHERE FPS.Pour LIKE \\'slab%\\' AND\\n             LOWER(TRIM(L.[Level]))!= \\'grade slab\\'\\n        GROUP BY P.Project_Identifier,OPTPM.Area\\n) A ON  CV.Project_Identifier = A.Project_Identifier\\n                        AND CV.Area = A.Area\\n) SGF\\nLEFT JOIN [DWH].[PLN_PROJECTS_DIM] P \\n                ON SGF.project_id = P.Project_Identifier\\n',",
				"     format: 'query',",
				"     staged: true) ~> STRUCTUREGAANTFINAL",
				"source(output(",
				"          ID as integer,",
				"          Sort_ID as integer,",
				"          Project_Identifier as string,",
				"          FLAT_COUNT as integer,",
				"          Project_Short as string,",
				"          Total_Floors as integer,",
				"          Total_Podiums as integer,",
				"          Total_Typical_Floor as integer,",
				"          Typical_Floor_Slab as integer,",
				"          Podium_Slab as integer,",
				"          ONE_BHK as integer,",
				"          TWO_BHK as integer,",
				"          ONE_FIVE_BHK as integer,",
				"          TWO_FIVE_BHK as integer,",
				"          THEREE_BHK as integer,",
				"          FOUR_BHK as integer,",
				"          FIVE_BHK as integer,",
				"          Actual_Start as timestamp,",
				"          BOQ_Value as string,",
				"          Bathrooms as integer,",
				"          Center_Tower as string,",
				"          Built_Up_Area as string,",
				"          Chairman_Lift as string,",
				"          Delay as string,",
				"          Duplex as string,",
				"          Fire_Lifts as integer,",
				"          Forecast_Duration as integer,",
				"          Forecast_Finish as timestamp,",
				"          Lat as string,",
				"          Long as string,",
				"          Office_Space as integer,",
				"          Office_Use_Lift as integer,",
				"          Parkings as integer,",
				"          Pent_House as integer,",
				"          Passenger_Lift as integer,",
				"          Project_Configuration as string,",
				"          Project_Duration as integer,",
				"          Project_Finish as timestamp,",
				"          Project_Start as timestamp,",
				"          Residence_Use_Lift as integer,",
				"          Retail as integer,",
				"          Service_Lift as integer,",
				"          Staircase_GF_L1 as integer,",
				"          Staircase_GF_Roof as integer,",
				"          Total_Units as integer,",
				"          Tower_A as string,",
				"          Tower_B as string,",
				"          Tower_C as string,",
				"          Tower_D as string,",
				"          Towers as string,",
				"          Image_Link as string,",
				"          Render_Image as string,",
				"          LoadDateTime as timestamp",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table',",
				"     staged: true) ~> PLNPROJECTSDIM",
				"source(output(",
				"          Upload_Time as date,",
				"          project_id as integer,",
				"          Group as string,",
				"          Activity_Description as string,",
				"          Baseline_Start_Date as date,",
				"          Baseline_Finish_Date as date,",
				"          Total_days as integer,",
				"          Days_elapsed as integer,",
				"          Completion_plan as integer,",
				"          Source_Templet as string,",
				"          Sort_Group as integer,",
				"          Sort_Activity as integer,",
				"          Activity_New as string,",
				"          FLAT_COUNT as integer,",
				"          Actual_Percentage as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: '\\n\\nSELECT \\n        DC.Upload_Time,\\n        P.project_id,\\n        DC.[Group],\\n        DC.[Activity_Description],\\n        DC.[Baseline_Start_Date],\\n        DC.[Baseline_Finish_Date],\\n        DATEDIFF(DAY,DC.[Baseline_Finish_Date], DC.[Baseline_Start_Date]) AS Total_days,\\n        DATEDIFF(DAY,GETDATE(), DC.[Baseline_Start_Date]) AS Days_elapsed,\\n        CASE WHEN DATEDIFF(DAY,DC.[Baseline_Finish_Date], DC.[Baseline_Start_Date]) = 0 THEN 0\\n            WHEN (DATEDIFF(DAY,GETDATE(), DC.[Baseline_Start_Date])/ DATEDIFF(DAY,DC.[Baseline_Finish_Date], DC.[Baseline_Start_Date])) < 1\\n                AND (DATEDIFF(DAY,GETDATE(), DC.[Baseline_Start_Date])/ DATEDIFF(DAY,DC.[Baseline_Finish_Date], DC.[Baseline_Start_Date])) > 0 \\n                THEN (DATEDIFF(DAY,GETDATE(), DC.[Baseline_Start_Date])/ DATEDIFF(DAY,DC.[Baseline_Finish_Date], DC.[Baseline_Start_Date]))\\n            WHEN (DATEDIFF(DAY,GETDATE(), DC.[Baseline_Start_Date])/ DATEDIFF(DAY,DC.[Baseline_Finish_Date], DC.[Baseline_Start_Date])) < 0 THEN 0\\n                ELSE 1\\n            END AS Completion_plan,\\n        CASE\\n--             For Manual Entry\\n            WHEN DC.[Group] = \\'Structural Works\\' AND DC.[Activity_Description] IN (\\'Pile Cap\\',\\'Pile\\')  THEN \\'MANUAL_ENTRY\\'\\n            WHEN DC.[Group] = \\'External Elevation\\' AND DC.[Activity_Description] IN (\\'ACP Works\\')  THEN \\'MANUAL_ENTRY\\'\\n            WHEN DC.[Group] = \\'Other & Specialist\\' AND DC.[Activity_Description] IN (\\n                                                                                    \\'Lift - CTU\\',\\n                                                                                    \\'Lift - Balance passenger lifts\\',\\n                                                                                    \\'Swimming Pool\\',\\n                                                                                    \\'Kids Play Area/ Outdoor Play Area\\',\\n                                                                                    \\'Changing Rooms / GYM\\',\\n                                                                                    \\'Wooden Decking\\'\\n                                                                                    )  THEN \\'MANUAL_ENTRY\\'\\n            WHEN DC.[Group] = \\'Authority Approvals\\' AND DC.[Activity_Description] IN ( \\n                                                                                    \\'Transformer payment\\',\\n                                                                                    \\'LV Inspection & Approval\\',\\n                                                                                    \\'BCC - Inspection & Approval\\',\\n                                                                                    \\'Power on\\'\\n                                                                                    ) THEN \\'MANUAL_ENTRY\\'\\n--         For Structures\\n            WHEN DC.[Group] = \\'Structural Works\\' AND DC.[Activity_Description] IN (\\'Grade Slab\\',\\'Podium Slabs\\',\\'Typical Floor Slabs\\')  THEN \\'PLN_STRUCTURE_FACT\\'\\n            WHEN DC.[Group] = \\'Structural Works\\' AND DC.[Activity_Description] NOT IN (\\'Pile\\',\\'Pile Cap\\',\\'Grade Slab\\',\\'Podium Slabs\\',\\'Typical Floor Slabs\\')  THEN \\'TBD\\'\\n--         For Dry Area\\n            WHEN DC.[Group] = \\'Masonary Works\\' AND DC.[Activity_Description] IN (\\'Blockworks\\')  THEN \\'PLN_DRYAREA_FACT\\'\\n            WHEN DC.[Group] = \\'Finishes - Dry Area\\' THEN \\'PLN_DRYAREA_FACT\\'\\n            WHEN DC.[Group] = \\'External Elevation\\' AND DC.[Activity_Description] IN (\\'Sliding Door\\')  THEN \\'PLN_DRYAREA_FACT\\'\\n--         For Wet Area    \\n            WHEN DC.[Group] = \\'Finishes - Wet Area\\' THEN \\'PLN_WETAREA_FACT\\'\\n            WHEN DC.[Group] = \\'Joinery Works\\' AND DC.[Activity_Description] IN (\\'Vanity Cabinet\\')  THEN \\'PLN_WETAREA_FACT\\'\\n--         For Corridor Area\\n            WHEN DC.[Group] = \\'Finishes - Corridor\\' THEN \\'PLN_CORRIDOR_FACT\\'\\n--         For Balcony Area\\n            WHEN DC.[Group] = \\'External Elevation\\' AND DC.[Activity_Description] IN (\\'EIFS\\',\\'Balustrade Works\\')  THEN \\'PLN_BALCONYAREA_FACT\\'\\n--         For Kitchen Area\\n            WHEN DC.[Group] = \\'Other & Specialist\\' AND DC.[Activity_Description] IN (\\'Kitchen Appliances\\')  THEN \\'PLN_KITCHENAREA_FACT\\'\\n            WHEN DC.[Group] = \\'Joinery Works\\' AND DC.[Activity_Description] IN (\\'Kitchen Cabinet\\')  THEN \\'PLN_KITCHENAREA_FACT\\'\\n--         For KeepOut Area\\n            WHEN DC.[Group] = \\'Keepout\\' THEN \\'PLN_KEEPOUT_FACT\\'\\n--         Yet to be Decided\\n            WHEN DC.[Group] = \\'Authority Approvals\\' AND DC.[Activity_Description] NOT IN ( \\n                                                                                    \\'Transformer payment\\',\\n                                                                                    \\'LV Inspection & Approval\\',\\n                                                                                    \\'BCC - Inspection & Approval\\',\\n                                                                                    \\'Power on\\'\\n                                                                                    ) THEN \\'TBD\\'\\n            WHEN DC.[Group] = \\'External Elevation\\' AND DC.[Activity_Description] NOT IN (\\'Sliding Door\\',\\'EIFS\\',\\'Balustrade Works\\',\\'ACP Works\\')  THEN \\'TBD\\'\\n            WHEN DC.[Group] = \\'Other & Specialist\\' AND DC.[Activity_Description] NOT IN (\\n                                                                                    \\'Kitchen Appliances\\',\\n                                                                                    \\'Lift - CTU\\',\\n                                                                                    \\'Lift - Balance passenger lifts\\',\\n                                                                                    \\'Swimming Pool\\',\\n                                                                                    \\'Kids Play Area/ Outdoor Play Area\\',\\n                                                                                    \\'Changing Rooms / GYM\\',\\n                                                                                    \\'Wooden Decking\\')  THEN \\'TBD\\'\\n            WHEN DC.[Group] = \\'Joinery Works\\' AND DC.[Activity_Description] NOT IN (\\'Vanity Cabinet\\',\\'Kitchen Cabinet\\')  THEN \\'TBD\\'\\n            ELSE \\'MISSING\\'\\n        END AS Source_Templet,\\n        OLMP.Sort_Group,\\n        OLMP.Sort_Activity,\\n        OLMP.Activity_New,\\n        P.FLAT_COUNT,\\n        DC.[Actual_Percentage]\\n--INTO #MILESTONE_MAIN_TABLE_Plan\\nFROM (\\nSELECT\\n        CAST(OPM.upload_time AS DATE) AS Upload_Time,\\n        OPM.project_id,\\n        OPM.[Group],\\n        OPM.[Activity_Description],\\n       -- REPLACE(OPM.[Baseline_Start],\\'-\\',\\'/\\') AS  [Baseline_Start_Date],\\n          CAST(REPLACE(OPM.[Baseline_Start],\\'-\\',\\'/\\') AS DATE) AS  [Baseline_Start_Date],[Baseline_Start],[Baseline_Finish],\\n          CAST(REPLACE(OPM.[Baseline_Finish],\\'-\\',\\'/\\') AS DATE) AS [Baseline_Finish_Date],\\n        DENSE_RANK() OVER( PARTITION BY OPM.project_id ORDER BY CAST(OPM.upload_time AS DATE) DESC) DENSERANK,\\n        OPM.[Actual_Percentage]\\n    FROM\\n        [STG].[O_PLN_MILESTONE_STG] OPM\\n        WHERE \\n        (OPM.[Group] IS NOT NULL AND TRIM(OPM.[Group]) NOT IN (\\'\\')\\n                AND OPM.[Activity_Description] IS NOT NULL AND TRIM(OPM.[Activity_Description]) NOT IN (\\'\\')\\n                AND OPM.[Baseline_Start] IS NOT NULL AND TRIM(OPM.[Baseline_Start]) NOT IN (\\'\\')\\n                AND OPM.[Baseline_Finish] IS NOT NULL AND TRIM(OPM.[Baseline_Finish]) NOT IN (\\'\\')\\n                )\\n) DC\\nLEFT JOIN [STG].[O_PLN_MILESTONE_MAP_STG] OLMP\\n                ON DC.[Group] = OLMP.[Group] \\n     AND DC.[Activity_Description] = OLMP.Activity\\nLEFT JOIN [DWH].[PLN_PROJECTS_DIM] P\\n                ON DC.project_id = P.Project_Identifier\\nWHERE DC.DENSERANK = 1',",
				"     format: 'query',",
				"     staged: true) ~> MILESTONEMAINTABLEPlan",
				"source(output(",
				"          Upload_Date as date,",
				"          project_id as integer,",
				"          Actual_Percentage as decimal(24,6),",
				"          Legend as string,",
				"          Sort_Group as integer,",
				"          Sort_Activity as integer,",
				"          Group as string,",
				"          Activity as string,",
				"          Activity_New as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT \\n        Upload_Time AS Upload_Date,\\n        project_id,\\n        --Description,\\n        [Actual_Percentage],\\n        \\'Actuals\\' AS Legend,\\n        OPMP.*\\n--INTO #Manual_Actuals\\nFROM (\\nSELECT \\n    CAST(OPM.upload_time AS DATE) AS Upload_Time,\\n    project_id,\\n    tower,\\n    sbu_id,\\n     [Activity],\\n    --Description,\\n    CASE \\n        WHEN [Actual_Percentage] IS NULL OR TRIM([Actual_Percentage]) IN (\\'\\') THEN 0\\n        ELSE ISNULL(CAST(REPLACE([Actual_Percentage],\\'%\\',\\'\\') AS DECIMAL),0.00)/100 \\n    END AS [Actual_Percentage],\\n    DENSE_RANK () OVER (PARTITION BY project_id ORDER BY CAST(OPM.upload_time AS DATE) DESC)  DenseRanker\\nFROM  [DWH].[PLN_MILESTONE_ACTUALS_TEMP_FACT] OPM\\n) C1\\nLEFT JOIN STG.O_PLN_MILESTONE_MAP_STG OPMP ON C1.[Activity] = OPMP.[Activity]\\n    WHERE DenseRanker = 1',",
				"     format: 'query',",
				"     staged: true) ~> ManualActuals",
				"source(output(",
				"          Sort_Group as integer,",
				"          Sort_Activity as decimal(12,1),",
				"          Group as string,",
				"          Activity as string,",
				"          Activity_New as string,",
				"          Legend as string,",
				"          NEW_ACT as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT \\n    Sort_Group,\\n    Sort_Activity+0.1 AS Sort_Activity,\\n    [Group],\\n    Activity,\\n    Activity_New,\\n    \\'Actuals\\' AS Legend,\\n    CONCAT(Activity_New,\\' : (A)\\') AS NEW_ACT  \\nFROM STG.O_PLN_MILESTONE_MAP_STG opmm \\nUNION ALL \\nSELECT \\n    Sort_Group,\\n    Sort_Activity,\\n    [Group],\\n    Activity,\\n    Activity_New,\\n    \\'Plan\\' AS Legend,\\n    CONCAT(Activity_New,\\' : (P)\\') AS NEW_ACT  \\nFROM STG.O_PLN_MILESTONE_MAP_STG opmm',",
				"     format: 'query',",
				"     staged: true) ~> OPLNMILESTONEMAPSTG",
				"Finalselect keyGenerate(output(SurrogateKey_ID as long),",
				"     startAt: 1L,",
				"     stepValue: 1L) ~> surrogateKey1",
				"surrogateKey1 derive(ID = SurrogateKey_ID+$MAX_ID,",
				"          LoadDateTime = currentUTC()) ~> derivedColumn1",
				"DRYAREAGAANTFINAL, WETAREAGAANTFINAL, CORRIDORGAANTFINAL, KITCHENGAANTFINAL, BALCONYGAANTFINAL, SLIDINGDOORGAANTFINAL, KITCHENCABINETGAANTFINAL, KEEPOUTGAANTFINAL, BLOCKWORKGAANTFINAL, BALUSTRADEWORKSGAANTFINAL, STRUCTUREGAANTFINAL union(byName: true)~> union1",
				"union1 derive(Milestone_Activity_Map = case(     \r",
				"     trim(Type_of_work) == 'FC BOARDING WITH JOINT TAPING' && Source_Table == 'PLN_DRYAREA_FACT','False Ceiling - Boarding',\r",
				"     trim(Type_of_work) == 'Plaster' && Source_Table == 'PLN_DRYAREA_FACT','Plaster',\r",
				"     trim(Type_of_work) == 'Screed' && Source_Table == 'PLN_DRYAREA_FACT','Screed',\r",
				"     trim(Type_of_work) == 'Floor Tiling' && Source_Table == 'PLN_DRYAREA_FACT','Floor Tiles',\r",
				"     trim(Type_of_work) == 'FC Framing' && Source_Table == 'PLN_DRYAREA_FACT','False Ceiling - Framing',\r",
				"     trim(Type_of_work) == 'Kitchen Cabinet' && Source_Table == 'PLN_KITCHENAREA_FACT','Kitchen Cabinet',\r",
				"     trim(Type_of_work) == 'KITCHEN APPLIANCES' && Source_Table == 'PLN_KITCHENAREA_FACT','Kitchen Appliances',\r",
				"     trim(Type_of_work) == 'Sliding Door' && Source_Table == 'PLN_DRYAREA_FACT','Sliding Door',\r",
				"     trim(Type_of_work) == 'Blockwork' && Source_Table == 'PLN_DRYAREA_FACT','Blockwork',\r",
				"     trim(Type_of_work) == 'Balustrade Works' && Source_Table == 'PLN_DRYAREA_FACT','Balustrade Works',\r",
				"     trim(Type_of_work) == 'Floor Tile' && Source_Table == 'PLN_CORRIDOR_FACT','Floor Tiles',\r",
				"    trim(Type_of_work) == 'CORRIDOR FLOOR TILE' && Source_Table == 'PLN_CORRIDOR_FACT','Floor Tiles',\r",
				"     trim(Type_of_work) == 'Wall Tile'  && Source_Table == 'PLN_CORRIDOR_FACT','Wall Tiles',\r",
				"    trim(Type_of_work) == 'CORRIDOR WALL TILE'  && Source_Table == 'PLN_CORRIDOR_FACT','Wall Tiles',\r",
				"     trim(Type_of_work) == 'FC Boarding' && Source_Table == 'PLN_CORRIDOR_FACT','False Ceiling - Boarding',\r",
				"    trim(Type_of_work) == 'CORRIDOR FC BOARDING' && Source_Table == 'PLN_CORRIDOR_FACT','False Ceiling - Boarding',\r",
				"     trim(Type_of_work)  == 'WET AREA SCREED'&& Source_Table == 'PLN_WETAREA_FACT','Screed',\r",
				"     trim(Type_of_work)  == 'Wet Area MEP H/L Boarding Clearance'&& Source_Table == 'PLN_WETAREA_FACT','MEP High Lvl',\r",
				"     trim(Type_of_work)  == 'WALL TILE BOTTOM TILE'&& Source_Table == 'PLN_WETAREA_FACT','Wall Tiles',\r",
				"     trim(Type_of_work)  == 'WET AREA FC FRAMING'&& Source_Table == 'PLN_WETAREA_FACT','False Ceiling - Framing',\r",
				"     trim(Type_of_work)  == 'FC BOARDING & JOINT TAPING'&& Source_Table == 'PLN_WETAREA_FACT','False Ceiling - Boarding',\r",
				"     trim(Type_of_work)  == 'Floor Tile'&& Source_Table == 'PLN_WETAREA_FACT','Floor Tiles',\r",
				"     trim(Type_of_work)  == 'Wet Area Final Fixtures Installation'&& Source_Table == 'PLN_WETAREA_FACT','MEP Final Fix',\r",
				"     trim(Type_of_work)  == 'Vanity Cabinet'&& Source_Table == 'PLN_WETAREA_FACT','Vanity Cabinet',\r",
				"     trim(Type_of_work)  == 'EIFS INSTALLATION'&& Source_Table == 'PLN_BALCONYAREA_FACT','EIFS',\r",
				"     trim(Type_of_work)  == 'Keep Out (QT)'&& Source_Table == 'PLN_KEEPOUT_FACT','CAP^Q Unit QT Keep-out approvals',\r",
				"     trim(Type_of_work)  == 'Kitchen Stamp - Civil (I9)'&& Source_Table == 'PLN_KEEPOUT_FACT','CAP^Q (Stamp - I9) Kitchen Keep-',\r",
				"     trim(Type_of_work)  == 'Bathroom Stamp - Civil (L9)'&& Source_Table == 'PLN_KEEPOUT_FACT','CAP^Q (Stamp - L9) Bathroom Keep',\r",
				"     trim(Type_of_work)  == 'Podium'&& Source_Table == 'PLN_STRUCTURE_FACT','Podium Slabs',\r",
				"     trim(Type_of_work)  == 'Grade Slab'&& Source_Table == 'PLN_STRUCTURE_FACT','Grade Slab',\r",
				"     trim(Type_of_work)  == 'Typical Floor'&& Source_Table == 'PLN_STRUCTURE_FACT','Typical Floor Slabs'\r",
				"     )) ~> ACTUALSCOLLECTOR",
				"MILESTONEMAINTABLE, PLNPROJECTSDIM join(project_id == Project_Identifier,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> joinwithProjectsDim",
				"joinwithProjectsDim, ACTUALSCOLLECTOR join(Sort_ID == union1@project_id",
				"     && Activity_Description == Milestone_Activity_Map",
				"     && Source_Templet == Source_Table,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> joinwithACTUALSCOLLECTOR",
				"joinwithACTUALSCOLLECTOR select(mapColumn(",
				"          Upload_Date = Upload_Time,",
				"          Sort_ID,",
				"          Group,",
				"          Activity_Description,",
				"          Activity_New,",
				"          Actual_Start_Date,",
				"          Actual_Finish_Date,",
				"          Total_days,",
				"          Days_elapsed,",
				"          Source_Templet,",
				"          Source_Table,",
				"          Sort_Group,",
				"          Sort_Activity,",
				"          Actual_Percentage,",
				"          FLAT_COUNT = MILESTONEMAINTABLE@FLAT_COUNT,",
				"          SUM_ALL,",
				"          Project_Identifier",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"select1 derive(Actual_Achived = toDecimal(SUM_ALL/FLAT_COUNT,12,4)) ~> ActualAchivedColumn",
				"ActualAchivedColumn select(mapColumn(",
				"          Upload_Date,",
				"          Project_ID = Sort_ID,",
				"          Group,",
				"          Activity_Description,",
				"          Activity_New,",
				"          Actual_Start_Date,",
				"          Actual_Finish_Date,",
				"          Total_days,",
				"          Days_elapsed,",
				"          Source_Templet,",
				"          Source_Table,",
				"          Sort_Group,",
				"          Sort_Activity,",
				"          Actual_Percentage,",
				"          FLAT_COUNT,",
				"          SUM_ALL,",
				"          Project_Identifier,",
				"          Actual_Achived",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> OUTPUTPlan",
				"OUTPUTPlan derive(Legend = 'Actuals') ~> LegendderivedColumnForOutputplan",
				"MILESTONEMAINTABLEPlan select(mapColumn(",
				"          Upload_Date = Upload_Time,",
				"          Project_ID = project_id,",
				"          Group,",
				"          Activity_Description,",
				"          Activity_New,",
				"          Actual_Achived = Completion_plan,",
				"          Actual_Start_Date = Baseline_Start_Date,",
				"          Actual_Finish_Date = Baseline_Finish_Date,",
				"          Total_days,",
				"          Days_elapsed,",
				"          Source_Templet,",
				"          Source_Table = Source_Templet,",
				"          Sort_Group,",
				"          Sort_Activity,",
				"          Actual_Percentage",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectListforMILESTONEMAINTABLEPlan",
				"select1 derive(Legend = 'Plan') ~> LegendderivedColumnForMILESTONEMAINTABLEPlan",
				"LegendderivedColumnForOutputplan, LegendderivedColumnForMILESTONEMAINTABLEPlan union(byName: true)~> UnionAllFinal",
				"UnionAllFinal, ManualActuals join(UnionAllFinal@Activity_New == ManualActuals@Activity_New",
				"     && UnionAllFinal@Project_ID == ManualActuals@project_id",
				"     && UnionAllFinal@Legend == ManualActuals@Legend,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"join1 select(mapColumn(",
				"          Upload_Date = UnionAllFinal@Upload_Date,",
				"          Project_ID = UnionAllFinal@Project_ID,",
				"          Group = UnionAllFinal@Group,",
				"          Activity_Description,",
				"          Activity_New = UnionAllFinal@Activity_New,",
				"          Actual_Start_Date,",
				"          Actual_Finish_Date,",
				"          Total_days,",
				"          Days_elapsed,",
				"          Source_Templet,",
				"          Source_Table,",
				"          Sort_Group = UnionAllFinal@Sort_Group,",
				"          Sort_Activity = UnionAllFinal@Sort_Activity,",
				"          Legend = UnionAllFinal@Legend,",
				"          Actual_Percentage = UnionAllFinal@Actual_Percentage,",
				"          Actual_Achived,",
				"          MAActual_Percentage = ManualActuals@Actual_Percentage,",
				"          Project_Identifier",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2",
				"select2 derive(Actual_Achived = case((Legend == 'Actuals') && in (['BCC - Inspection & Approval','Power on','LV Inspection & Approval','Wooden Decking','ACP Works','Kids Play Area/ Outdoor Play Area','Swimming Pool','Changing Rooms / GYM','Lift - Balance passenger lifts','Lift - CTU','Pile Cap','Transformer payment','Pile'],trim (Activity_New))  , MAActual_Percentage,Actual_Achived )) ~> ActualAchivedderivedColumn",
				"ActualAchivedderivedColumn derive(Actual_Achived_New = case(iifNull(Actual_Achived,0) >1 ,toDecimal(1) ,iifNull(Actual_Achived,0))) ~> ActualAchivedderivedColumn2",
				"ActualAchivedderivedColumn2 derive(PLN_ACT = concat(Legend,' : ', toString( toDecimal( Actual_Achived_New*100,10,0)),'%')) ~> PLNACTderivedColumn",
				"PLNACTderivedColumn filter(!isNull(Activity_New)) ~> ActivityNewfilter",
				"ActivityNewfilter select(mapColumn(",
				"          Upload_Date,",
				"          Project_ID,",
				"          Group,",
				"          Activity_Description,",
				"          Activity_New,",
				"          Original_Actuals = Actual_Achived,",
				"          Actual_Achived = Actual_Achived_New,",
				"          Actual_Start_Date,",
				"          Actual_Finish_Date,",
				"          Total_days,",
				"          Days_elapsed,",
				"          Source_Templet,",
				"          Source_Table,",
				"          Sort_Group,",
				"          Sort_Activity,",
				"          Legend,",
				"          Actual_Percentage,",
				"          PLN_ACT,",
				"          Project_Identifier",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> AUGGAANTTEST",
				"AUGGAANTTEST, OPLNMILESTONEMAPSTG join(AUGGAANTTEST@Legend == OPLNMILESTONEMAPSTG@Legend",
				"     && AUGGAANTTEST@Activity_New == OPLNMILESTONEMAPSTG@Activity_New",
				"     && Activity_Description == Activity",
				"     && AUGGAANTTEST@Group == OPLNMILESTONEMAPSTG@Group,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> SEPTGAANTTESTTemp",
				"SEPTGAANTTESTTemp select(mapColumn(",
				"          Upload_Date,",
				"          Project_ID,",
				"          Group = AUGGAANTTEST@Group,",
				"          Activity_Description,",
				"          Activity_New = AUGGAANTTEST@Activity_New,",
				"          Original_Actuals,",
				"          Actual_Achived,",
				"          Actual_Start_Date,",
				"          Actual_Finish_Date,",
				"          Total_days,",
				"          Days_elapsed,",
				"          Source_Templet,",
				"          Source_Table,",
				"          Sort_Group = AUGGAANTTEST@Sort_Group,",
				"          Sort_Activity = AUGGAANTTEST@Sort_Activity,",
				"          Legend = AUGGAANTTEST@Legend,",
				"          Actual_Percentage,",
				"          PLN_ACT,",
				"          Project_Identifier,",
				"          Sort_Group = OPLNMILESTONEMAPSTG@Sort_Group,",
				"          Sort_Activity = OPLNMILESTONEMAPSTG@Sort_Activity,",
				"          Group = OPLNMILESTONEMAPSTG@Group,",
				"          Activity,",
				"          Activity_New = OPLNMILESTONEMAPSTG@Activity_New,",
				"          Legend = OPLNMILESTONEMAPSTG@Legend,",
				"          NEW_ACT,",
				"          Project_Identifier",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SEPTGAANTTEST",
				"SEPTGAANTTEST derive(Manual_Values = case( trim(Actual_Percentage) == ' ',toDecimal(0),trim(Actual_Percentage) == '',toDecimal(0),isNull(trim(Actual_Percentage)),toDecimal(0),toDecimal(replace(Actual_Percentage, '%', ''))/100)) ~> ManualAdditionToCode",
				"ManualAdditionToCode derive(Actual_AchivedNew = case(\r",
				"    Actual_Achived <= Manual_Values && Legend == 'Actuals', Manual_Values, Actual_Achived\r",
				")) ~> FinalFinalderivedColumn",
				"FinalFinalderivedColumn derive(PLN_ACT_NEW = concat(Legend,' : ', toString(toDecimal( Actual_AchivedNew * 100,10,0 )),'%' )) ~> PLNACTNewderivedColumn",
				"PLNACTNewderivedColumn select(mapColumn(",
				"          Upload_Date,",
				"          Project_ID,",
				"          Group,",
				"          Activity_Description,",
				"          Activity_New,",
				"          Original_Actuals,",
				"          Actual_Achived,",
				"          Actual_Start_Date,",
				"          Actual_Finish_Date,",
				"          Total_days,",
				"          Days_elapsed,",
				"          Source_Templet,",
				"          Source_Table,",
				"          Sort_Group,",
				"          Sort_Activity,",
				"          Legend,",
				"          Actual_Percentage,",
				"          PLN_ACT,",
				"          Project_Identifier,",
				"          Activity,",
				"          NEW_ACT,",
				"          Manual_Values,",
				"          Actual_AchivedNew,",
				"          PLN_ACT_NEW,",
				"          Project_Identifier",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> Finalselect",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          ID as integer,",
				"          Upload_Date as timestamp,",
				"          project_id as integer,",
				"          Project_Identifier as string,",
				"          Group as string,",
				"          Sort_Grp as integer,",
				"          Activity_New as string,",
				"          Activity_Description as string,",
				"          Sort_Activity as string,",
				"          Actual_Start_Date as timestamp,",
				"          Actual_Finish_Date as timestamp,",
				"          Original_Actuals as string,",
				"          Actual_Achived as string,",
				"          Legend as string,",
				"          PLN_ACT as string,",
				"          LoadDateTime as timestamp",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     staged: true,",
				"     allowCopyCommand: true,",
				"     preSQLs:['Truncate table DWH.PLN_GAANT_HURRY_FACT;'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          ID,",
				"          Upload_Date,",
				"          project_id = Project_ID,",
				"          Project_Identifier,",
				"          Group,",
				"          Sort_Grp = Sort_Group,",
				"          Activity_New,",
				"          Activity_Description,",
				"          Sort_Activity,",
				"          Actual_Start_Date,",
				"          Actual_Finish_Date,",
				"          Original_Actuals,",
				"          Actual_Achived,",
				"          Legend,",
				"          PLN_ACT,",
				"          LoadDateTime",
				"     )) ~> sink1"
			]
		}
	}
}