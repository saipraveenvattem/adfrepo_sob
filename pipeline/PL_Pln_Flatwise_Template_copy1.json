{
	"name": "PL_Pln_Flatwise_Template_copy1",
	"properties": {
		"activities": [
			{
				"name": "Wet Area Template",
				"type": "Lookup",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureMySqlSource",
						"query": "TRUNCATE TABLE f_pln_wetarea;\r\nINSERT INTO f_pln_wetarea\r\nWITH PRE_STAGGING AS (\r\n\r\n    SELECT\r\n\r\n        DATE(O_PLN_WETAREA_RAW.upload_time) AS Upload_Date,\r\n\r\n        O_PLN_WETAREA_RAW.project_id,\r\n\r\n        O_PLN_WETAREA_RAW.tower,\r\n\r\n        O_PLN_WETAREA_RAW.`Level`,\r\n\r\n        O_PLN_WETAREA_RAW.Flat,\r\n\r\n        'Wet Area' AS sclicer,\r\n\r\n        Column_Name.*,\r\n\r\n        O_PLN_WETAREA_MAP.ACTIVITY_ID,\r\n\r\n        O_PLN_WETAREA_MAP.SBU_ID,\r\n\r\n        O_PLN_WETAREA_MAP.Category,\r\n\r\n        DENSE_RANK () OVER (PARTITION BY  project_id\r\n\r\n                                ORDER BY  DATE(upload_time) DESC\r\n\r\n                                )   AS  Project_Udate_DRANK\r\n\r\n    from O_PLN_WETAREA_RAW\r\n\r\n    cross join lateral (\r\n\r\n                SELECT `Plastering Clearance with 1 Mtr Marking`             ,               'Plastering Clearance with 1 Mtr Marking'\r\n\r\nUNION ALL SELECT           `Wet Area Tile Marking` ,               'Wet Area Tile Marking'\r\n\r\nUNION ALL SELECT           `MEP Marking`  ,               'MEP Marking'\r\n\r\nUNION ALL SELECT           `Wet Area Cutting & Chasing`      ,               'Wet Area Cutting & Chasing'\r\n\r\nUNION ALL SELECT           `Pex pipe installation`     ,               'Pex pipe installation'\r\n\r\nUNION ALL SELECT           `Re packing of MEP Services`       ,               'Re packing of MEP Services'\r\n\r\nUNION ALL SELECT           `MEP Pipe installation - Borepacking`      ,               'MEP Pipe installation - Borepacking'\r\n\r\nUNION ALL SELECT           `Wet Area Bore Packing`               ,               'Wet Area Bore Packing'\r\n\r\nUNION ALL SELECT           `Cistern installation`        ,               'Cistern installation'\r\n\r\nUNION ALL SELECT           `Drywall framing`             ,               'Drywall framing'\r\n\r\nUNION ALL SELECT           `Pex Elbow & Connections`          ,               'Pex Elbow & Connections'\r\n\r\nUNION ALL SELECT           `Bottom Boarding Clearance`      ,               'Bottom Boarding Clearance'\r\n\r\nUNION ALL SELECT           `Bottom boarding`           ,               'Bottom boarding'\r\n\r\nUNION ALL SELECT           `Under Screed Waterproofing`   ,               'Under Screed Waterproofing'\r\n\r\nUNION ALL SELECT           `Wet Area Screed`           ,               'Wet Area Screed'\r\n\r\nUNION ALL SELECT           `Ledge Wall Full Board Closure Clearance`             ,               'Ledge Wall Full Board Closure Clearance'\r\n\r\nUNION ALL SELECT           `MEP HL Water Supply & Drainage`          ,               'MEP HL Water Supply & Drainage '\r\n\r\nUNION ALL SELECT           `MEP HL Ducting & FCU Works`  ,               'MEP HL Ducting & FCU Works '\r\n\r\nUNION ALL SELECT           `MEP HL Electrical Services Installation`  ,               'MEP HL Electrical Services Installation'\r\n\r\nUNION ALL SELECT           `MEP HL Works & Testing`            ,               'MEP HL Works & Testing'\r\n\r\nUNION ALL SELECT           `MEP HL Packing Clearance`         ,               'MEP HL Packing Clearance'\r\n\r\nUNION ALL SELECT           `Packing for all builders work opening`   ,               'Packing for all builders work opening '\r\n\r\nUNION ALL SELECT           `Wet Area MEP H/L Fire Sealent & Framing Clearance`     ,               'Wet Area MEP H/L Fire Sealent & Framing Clearance '\r\n\r\nUNION ALL SELECT           `Wet area Wall Tile`         ,               'Wet area Wall Tile'\r\n\r\nUNION ALL SELECT           `Wet Area FC Framing`   ,               'Wet Area FC Framing'\r\n\r\nUNION ALL SELECT           `Wet Area MEP H/L Boarding Clearance` ,               'Wet Area MEP H/L Boarding Clearance'\r\n\r\nUNION ALL SELECT           `FC Boarding & Joint Taping`        ,               'FC Boarding & Joint Taping'\r\n\r\nUNION ALL SELECT           `Ceiling Paint Primer`      ,               'Ceiling Paint Primer'\r\n\r\nUNION ALL SELECT           `Ceiling Paint Stucco 1st Coat & 2nd Coat`             ,               'Ceiling Paint Stucco 1st Coat & 2nd Coat'\r\n\r\nUNION ALL SELECT           `Wet Area Ceiling First Coat Paint`            ,               'Wet Area Ceiling First Coat Paint'\r\n\r\nUNION ALL SELECT           `MEP Grill & Diffuser Installtion` ,               'MEP Grill & Diffuser Installtion '\r\n\r\nUNION ALL SELECT           `Shower Threshold`         ,               'Shower Threshold'\r\n\r\nUNION ALL SELECT           `Linear Drain Supply`      ,               'Linear Drain Supply'\r\n\r\nUNION ALL SELECT           `Linear Drain Fixing`        ,               'Linear Drain Fixing '\r\n\r\nUNION ALL SELECT           `Under Tile Waterproofing`         ,               'Under Tile Waterproofing'\r\n\r\nUNION ALL SELECT           `Bathroom Door Threshold`         ,               'Bathroom Door Threshold'\r\n\r\nUNION ALL SELECT           `Wet Area Floor Tile`       ,               'Wet Area Floor Tile'\r\n\r\nUNION ALL SELECT           `Wall tile bottom Tile`     ,               'Wall tile bottom Tile'\r\n\r\nUNION ALL SELECT           `Grouting - Wall & Floor`               ,               'Grouting - Wall & Floor'\r\n\r\nUNION ALL SELECT           `Silicone - Wall & Floor Corners` ,               'Silicone - Wall & Floor Corners'\r\n\r\nUNION ALL SELECT           `Shower Partition - U channel`    ,               'Shower Partition - U channel'\r\n\r\nUNION ALL SELECT           `Shower Partition - Glass`             ,               'Shower Partition - Glass'\r\n\r\nUNION ALL SELECT           `Accessories & Silicon`    ,               'Accessories & Silicon'\r\n\r\nUNION ALL SELECT           `Bathroom Door - Frame Installation`      ,               'Bathroom Door - Frame Installation'\r\n\r\nUNION ALL SELECT           `Bathroom Door - Architrave Installation`              ,               'Bathroom Door - Architrave Installation'\r\n\r\nUNION ALL SELECT           `Bathroom Door - Shutter Installation`    ,               'Bathroom Door - Shutter Installation'\r\n\r\nUNION ALL SELECT           `Bathroom Door - Ironmongery Installation`         ,               'Bathroom Door - Ironmongery Installation'\r\n\r\nUNION ALL SELECT           `Vanity Cabinet` ,               'Vanity Cabinet'\r\n\r\nUNION ALL SELECT           `Vanity Cabinet Counter top`       ,               'Vanity Cabinet Counter top'\r\n\r\nUNION ALL SELECT           `MEP Final Fixtures (Sanitary ,CP fittings & Lights,WB)`    ,               'MEP Final Fixtures (Sanitary ,CP fittings & Lights,WB)'\r\n\r\nUNION ALL SELECT           `MEP Ledge Wall Clearance`        ,               'MEP Ledge Wall Clearance '\r\n\r\nUNION ALL SELECT           `Ledge Wall Closing`        ,               'Ledge Wall Closing'\r\n\r\nUNION ALL SELECT           `Silicone around MEP Fixtures`   ,               'Silicone around MEP Fixtures'\r\n\r\nUNION ALL SELECT           `Wet Area Final Coat paint`          ,               'Wet Area Final Coat paint'\r\n\r\n \r\n\r\n            )\r\n\r\n              as Column_Name(value,Type_of_work)\r\n\r\n        JOIN O_PLN_WETAREA_MAP\r\n\r\n        ON TRIM(Column_Name.Type_of_work) = TRIm(O_PLN_WETAREA_MAP.ACTIVITY_SEQUENCE)\r\n\r\n        WHERE value IS NOT NULL)\r\n\r\nSELECT\r\n\r\n    PS.Upload_Date    ,\r\n\r\n    PS.project_id    ,\r\n\r\n    PS.tower    ,\r\n\r\n    PS.`Level`    ,\r\n\r\n    PS.Flat    ,\r\n\r\n    PS.sclicer    ,\r\n\r\n    CASE\r\n\r\n        WHEN PS.value IN ('','NA','-') THEN '0%'\r\n\r\n        ELSE PS.value\r\n\r\n    END AS value,\r\n\r\n    PS.Type_of_work    ,\r\n\r\n    PS.ACTIVITY_ID    ,\r\n\r\n    PS.SBU_ID    ,\r\n\r\n    PS.Category    ,\r\n\r\n    OLMA.level_map\r\n\r\nFROM PRE_STAGGING PS\r\n\r\n    LEFT JOIN O_LEVEL_MAP_ALL OLMA\r\n\r\n        ON PS.`Level` = OLMA.`level`\r\n\r\nWHERE Project_Udate_DRANK = 1;\r\n\r\n/**/\r\n\r\nSELECT 1;",
						"queryTimeout": "02:00:00"
					},
					"dataset": {
						"referenceName": "DS_MySQL_Data_Loads_DB",
						"type": "DatasetReference"
					}
				}
			}
		],
		"annotations": [],
		"lastPublishTime": "2023-01-01T12:06:38Z"
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}